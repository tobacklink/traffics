/*!
  * Auth App v1.0.0 (https://www.vorecorp.id)
  * Copyright 2018 Vore Corporation
  * Licensed under MIT
  */
function get_ip(){$.getJSON("//api.ipify.org?format=jsonp&callback=?",function(t){return t.ip})}function dec2hex(t){return(t<15.5?"0":"")+Math.round(t).toString(16)}function hex2dec(t){return parseInt(t,16)}function base32tohex(t){for(var e="",n="",i=0;i<t.length;i++){e+=leftpad("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".indexOf(t.charAt(i).toUpperCase()).toString(2),5,"0")}for(i=0;i+4<=e.length;i+=4){var r=e.substr(i,4);n+=parseInt(r,2).toString(16)}return n}function leftpad(t,e,n){return e+1>=t.length&&(t=Array(e+1-t.length).join(n)+t),t}function checkOtp(t,e){var n=base32tohex(e),i=Math.round((new Date).getTime()/1e3),r=leftpad(dec2hex(Math.floor(i/30)),16,"0"),s=new jsSHA("SHA-1","HEX");s.setHMACKey(n,"HEX"),s.update(r);var a=s.getHMAC("HEX"),o=0;"KEY MUST BE IN BYTE INCREMENTS"!==a&&(o=hex2dec(a.substring(a.length-1)));var c="https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=200x200&chld=M|0&cht=qr&chl=otpauth://totp/"+t+"%3Fsecret%3D"+e,h=(hex2dec(a.substr(2*o,8))&hex2dec("7fffffff"))+"";return[{qrcode:c,otpcode:h=h.substr(h.length-6,6)}]}var Twofactor=Class({constructor:function(t,e){this.account=t,this.secretkey=e},getotp:function(){return checkOtp(this.account,this.secretkey)[0].otpcode},getqr:function(){return checkOtp(this.account,this.secretkey)[0].qrcode}}),Session=Class({constructor:function(t){this.name=t},data:{get:function(){return this._data},set:function(t){this._data=t}},days:{get:function(){return this._days},set:function(t){this._days=t}},create:function(){var t=this,e="";if(void 0!=t.days){var n=new Date;n.setTime(n.getTime()+24*t.days*60*60*1e3),e="; expires="+n.toUTCString()}document.cookie=t.name+"="+t.data+e+"; path=/"},check:function(){for(var t=this.name+"=",e=document.cookie.split(";"),n=0;n<e.length;n++){for(var i=e[n];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return null},clear:function(){var t=this;t.data="",t.days=-1,t.create()}}),Auth=Class({constructor:function(t,e){this.client=t,this.auth=e},member:function(){var t=get_ip(),e=md5(this.client+"_"+t);if(this.auth==e)return!0;window.location="/p/login.html"},public:function(){var t=get_ip(),e=md5(this.client+"_"+t);if(this.auth!=e)return!0;window.location="/"}}),Parameter=Class({constructor:function(t){this.param=t},get:function(){for(var t=window.location.search.substr(1).split("&"),e=0;e<t.length;e++){var n=t[e].split("=");if(n[0]==this.param)return decodeURIComponent(n[1])}return!1}}),BtnStatus=Class({constructor:function(t,e,n){this.btn=t,this.htmldefault=e,this.htmldisabled=n},btndefault:function(){$(this.btn).html(this.htmldefault),$(this.btn).removeAttr("disabled"),$(this.btn).removeClass("disabled")},btndisabled:function(){$(this.btn).html(this.htmldisabled),$(this.btn).attr("disabled","disabled"),$(this.btn).addClass("disabled")}});